{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\amand\\\\OneDrive\\\\Desktop\\\\Social\\\\create-social-network\\\\hellobaby\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\amand\\\\OneDrive\\\\Desktop\\\\Social\\\\create-social-network\\\\hellobaby\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\amand\\\\OneDrive\\\\Desktop\\\\Social\\\\create-social-network\\\\hellobaby\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:\\\\Users\\\\amand\\\\OneDrive\\\\Desktop\\\\Social\\\\create-social-network\\\\hellobaby\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"C:\\\\Users\\\\amand\\\\OneDrive\\\\Desktop\\\\Social\\\\create-social-network\\\\hellobaby\\\\frontend\\\\src\\\\components\\\\CreatePost.js\";\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n  border-top: 1px solid \", \";\\n  padding: \", \" 0;\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 150px;\\n  height: 150px;\\n  overflow: hidden;\\n  flex-shrink: 0;\\n  box-shadow: \", \";\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  margin: 0 \", \";\\n  padding-left: \", \";\\n  padding-top: \", \";\\n  border: 0;\\n  outline: none;\\n  resize: none;\\n  transition: 0.1s ease-out;\\n  height: \", \";\\n  font-size: \", \";\\n  background-color: \", \";\\n  border-radius: \", \";\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n  padding: \", \" 0;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  border: 0;\\n  border: 1px solid \", \";\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport { Spacing, Overlay, Container } from 'components/Layout';\nimport { Error } from 'components/Text';\nimport { Button } from 'components/Form';\nimport Avatar from 'components/Avatar';\nimport PostImageUpload from 'pages/Home/PostImageUpload';\nimport { GET_FOLLOWED_POSTS, CREATE_POST } from 'graphql/post';\nimport { GET_AUTH_USER, GET_USER_POSTS } from 'graphql/user';\nimport { useStore } from 'store';\nimport { PROFILE_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\nimport { HOME_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\nimport { MAX_POST_IMAGE_SIZE } from 'constants/ImageSize';\nimport { useGlobalMessage } from 'hooks/useGlobalMessage';\nvar Root = styled(Container)(_templateObject(), function (p) {\n  return p.theme.colors.border.main;\n});\nvar Wrapper = styled.div(_templateObject2(), function (p) {\n  return p.theme.spacing.sm;\n});\nvar Textarea = styled.textarea(_templateObject3(), function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.spacing.sm;\n}, function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.focus ? '80px' : '40px';\n}, function (p) {\n  return p.theme.font.size.xs;\n}, function (p) {\n  return p.theme.colors.grey[100];\n}, function (p) {\n  return p.theme.radius.md;\n});\nvar ImagePreviewContainer = styled.div(_templateObject4(), function (p) {\n  return p.theme.shadows.sm;\n});\nvar ImagePreview = styled.img(_templateObject5());\nvar Options = styled.div(_templateObject6(), function (p) {\n  return p.theme.colors.border.main;\n}, function (p) {\n  return p.theme.spacing.sm;\n});\nvar Buttons = styled.div(_templateObject7());\n/**\r\n * Component for creating a post\r\n */\n\nvar CreatePost = function CreatePost() {\n  var _useStore = useStore(),\n      _useStore2 = _slicedToArray(_useStore, 1),\n      auth = _useStore2[0].auth;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      title = _useState2[0],\n      setTitle = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      image = _useState4[0],\n      setImage = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isFocused = _useState6[0],\n      setIsFocused = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      error = _useState8[0],\n      setError = _useState8[1];\n\n  var message = useGlobalMessage();\n\n  var handleReset = function handleReset() {\n    setTitle('');\n    setImage('');\n    setIsFocused(false);\n    setError('');\n  };\n\n  var handleOnFocus = function handleOnFocus() {\n    return setIsFocused(true);\n  };\n\n  var handlePostImageUpload = function handlePostImageUpload(e) {\n    var file = e.target.files[0];\n    if (!file) return;\n\n    if (file.size >= MAX_POST_IMAGE_SIZE) {\n      message.error(\"File size should be less then \".concat(MAX_POST_IMAGE_SIZE / 1000000, \"MB\"));\n      return;\n    }\n\n    setImage(file);\n    setIsFocused(true);\n    e.target.value = null;\n  };\n\n  var handleTitleChange = function handleTitleChange(e) {\n    return setTitle(e.target.value);\n  };\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e, createPost) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              createPost();\n              handleReset();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Mutation, {\n    mutation: CREATE_POST,\n    variables: {\n      input: {\n        title: title,\n        image: image,\n        authorId: auth.user.id\n      }\n    },\n    refetchQueries: function refetchQueries() {\n      return [{\n        query: GET_FOLLOWED_POSTS,\n        variables: {\n          userId: auth.user.id,\n          skip: 0,\n          limit: HOME_PAGE_POSTS_LIMIT\n        }\n      }, {\n        query: GET_AUTH_USER\n      }, {\n        query: GET_USER_POSTS,\n        variables: {\n          username: auth.user.username,\n          skip: 0,\n          limit: PROFILE_PAGE_POSTS_LIMIT\n        }\n      }];\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, function (createPost, _ref2) {\n    var loading = _ref2.loading,\n        apiError = _ref2.error;\n    var isShareDisabled = loading || !loading && !image && !title;\n    return React.createElement(React.Fragment, null, isFocused && React.createElement(Overlay, {\n      onClick: handleReset,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), React.createElement(Root, {\n      zIndex: isFocused ? 'md' : 'xs',\n      color: \"white\",\n      radius: \"sm\",\n      padding: \"sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: function onSubmit(e) {\n        return handleSubmit(e, createPost);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(Wrapper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(Avatar, {\n      image: auth.user.image,\n      size: 40,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }), React.createElement(Textarea, {\n      type: \"textarea\",\n      name: \"title\",\n      focus: isFocused,\n      value: title,\n      onFocus: handleOnFocus,\n      onChange: handleTitleChange,\n      placeholder: \"Crie uma postagem\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }), !isFocused && React.createElement(PostImageUpload, {\n      handleChange: handlePostImageUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    })), image && React.createElement(Spacing, {\n      bottom: \"sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(ImagePreviewContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(ImagePreview, {\n      src: URL.createObjectURL(image),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }))), isFocused && React.createElement(Options, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(PostImageUpload, {\n      label: \"Foto\",\n      handleChange: handlePostImageUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }), React.createElement(Buttons, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(Button, {\n      text: true,\n      type: \"button\",\n      onClick: handleReset,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"Cancelar\"), React.createElement(Button, {\n      disabled: isShareDisabled,\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Compartilha\"))), apiError || error && React.createElement(Spacing, {\n      top: \"xs\",\n      bottom: \"sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(Error, {\n      size: \"xs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, apiError ? 'Something went wrong, please try again.' : error)))));\n  });\n};\n\nexport default CreatePost;","map":{"version":3,"sources":["C:/Users/amand/OneDrive/Desktop/Social/create-social-network/hellobaby/frontend/src/components/CreatePost.js"],"names":["React","useState","Mutation","styled","Spacing","Overlay","Container","Error","Button","Avatar","PostImageUpload","GET_FOLLOWED_POSTS","CREATE_POST","GET_AUTH_USER","GET_USER_POSTS","useStore","PROFILE_PAGE_POSTS_LIMIT","HOME_PAGE_POSTS_LIMIT","MAX_POST_IMAGE_SIZE","useGlobalMessage","Root","p","theme","colors","border","main","Wrapper","div","spacing","sm","Textarea","textarea","xs","focus","font","size","grey","radius","md","ImagePreviewContainer","shadows","ImagePreview","img","Options","Buttons","CreatePost","auth","title","setTitle","image","setImage","isFocused","setIsFocused","error","setError","message","handleReset","handleOnFocus","handlePostImageUpload","e","file","target","files","value","handleTitleChange","handleSubmit","createPost","preventDefault","input","authorId","user","id","query","variables","userId","skip","limit","username","loading","apiError","isShareDisabled","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { Mutation } from 'react-apollo';\r\nimport styled from 'styled-components';\r\n\r\nimport { Spacing, Overlay, Container } from 'components/Layout';\r\nimport { Error } from 'components/Text';\r\nimport { Button } from 'components/Form';\r\nimport Avatar from 'components/Avatar';\r\n\r\nimport PostImageUpload from 'pages/Home/PostImageUpload';\r\n\r\nimport { GET_FOLLOWED_POSTS, CREATE_POST } from 'graphql/post';\r\nimport { GET_AUTH_USER, GET_USER_POSTS } from 'graphql/user';\r\n\r\nimport { useStore } from 'store';\r\n\r\nimport { PROFILE_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\r\nimport { HOME_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\r\nimport { MAX_POST_IMAGE_SIZE } from 'constants/ImageSize';\r\n\r\nimport { useGlobalMessage } from 'hooks/useGlobalMessage';\r\n\r\nconst Root = styled(Container)`\r\n  border: 0;\r\n  border: 1px solid ${p => p.theme.colors.border.main};\r\n`;\r\n\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  padding: ${p => p.theme.spacing.sm} 0;\r\n`;\r\n\r\nconst Textarea = styled.textarea`\r\n  width: 100%;\r\n  margin: 0 ${p => p.theme.spacing.xs};\r\n  padding-left: ${p => p.theme.spacing.sm};\r\n  padding-top: ${p => p.theme.spacing.xs};\r\n  border: 0;\r\n  outline: none;\r\n  resize: none;\r\n  transition: 0.1s ease-out;\r\n  height: ${p => (p.focus ? '80px' : '40px')};\r\n  font-size: ${p => p.theme.font.size.xs};\r\n  background-color: ${p => p.theme.colors.grey[100]};\r\n  border-radius: ${p => p.theme.radius.md};\r\n`;\r\n\r\nconst ImagePreviewContainer = styled.div`\r\n  width: 150px;\r\n  height: 150px;\r\n  overflow: hidden;\r\n  flex-shrink: 0;\r\n  box-shadow: ${p => p.theme.shadows.sm};\r\n`;\r\n\r\nconst ImagePreview = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n`;\r\n\r\nconst Options = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  border-top: 1px solid ${p => p.theme.colors.border.main};\r\n  padding: ${p => p.theme.spacing.sm} 0;\r\n`;\r\n\r\nconst Buttons = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n`;\r\n\r\n/**\r\n * Component for creating a post\r\n */\r\nconst CreatePost = () => {\r\n  const [{ auth }] = useStore();\r\n  const [title, setTitle] = useState('');\r\n  const [image, setImage] = useState('');\r\n  const [isFocused, setIsFocused] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const message = useGlobalMessage();\r\n\r\n  const handleReset = () => {\r\n    setTitle('');\r\n    setImage('');\r\n    setIsFocused(false);\r\n    setError('');\r\n  };\r\n\r\n  const handleOnFocus = () => setIsFocused(true);\r\n\r\n  const handlePostImageUpload = e => {\r\n    const file = e.target.files[0];\r\n\r\n    if (!file) return;\r\n\r\n    if (file.size >= MAX_POST_IMAGE_SIZE) {\r\n      message.error(\r\n        `File size should be less then ${MAX_POST_IMAGE_SIZE / 1000000}MB`\r\n      );\r\n      return;\r\n    }\r\n\r\n    setImage(file);\r\n\r\n    setIsFocused(true);\r\n    e.target.value = null;\r\n  };\r\n\r\n  const handleTitleChange = e => setTitle(e.target.value);\r\n\r\n  const handleSubmit = async (e, createPost) => {\r\n    e.preventDefault();\r\n    createPost();\r\n    handleReset();\r\n  };\r\n\r\n  return (\r\n    <Mutation\r\n      mutation={CREATE_POST}\r\n      variables={{ input: { title, image, authorId: auth.user.id } }}\r\n      refetchQueries={() => [\r\n        {\r\n          query: GET_FOLLOWED_POSTS,\r\n          variables: {\r\n            userId: auth.user.id,\r\n            skip: 0,\r\n            limit: HOME_PAGE_POSTS_LIMIT,\r\n          },\r\n        },\r\n        { query: GET_AUTH_USER },\r\n        {\r\n          query: GET_USER_POSTS,\r\n          variables: {\r\n            username: auth.user.username,\r\n            skip: 0,\r\n            limit: PROFILE_PAGE_POSTS_LIMIT,\r\n          },\r\n        },\r\n      ]}\r\n    >\r\n      {(createPost, { loading, error: apiError }) => {\r\n        const isShareDisabled = loading || (!loading && !image && !title);\r\n\r\n        return (\r\n          <>\r\n            {isFocused && <Overlay onClick={handleReset} />}\r\n\r\n            <Root\r\n              zIndex={isFocused ? 'md' : 'xs'}\r\n              color=\"white\"\r\n              radius=\"sm\"\r\n              padding=\"sm\"\r\n            >\r\n              <form onSubmit={e => handleSubmit(e, createPost)}>\r\n                <Wrapper>\r\n                  <Avatar image={auth.user.image} size={40} />\r\n\r\n                  <Textarea\r\n                    type=\"textarea\"\r\n                    name=\"title\"\r\n                    focus={isFocused}\r\n                    value={title}\r\n                    onFocus={handleOnFocus}\r\n                    onChange={handleTitleChange}\r\n                    placeholder=\"Crie uma postagem\"\r\n                  />\r\n\r\n                  {!isFocused && (\r\n                    <PostImageUpload handleChange={handlePostImageUpload} />\r\n                  )}\r\n                </Wrapper>\r\n\r\n                {image && (\r\n                  <Spacing bottom=\"sm\">\r\n                    <ImagePreviewContainer>\r\n                      <ImagePreview src={URL.createObjectURL(image)} />\r\n                    </ImagePreviewContainer>\r\n                  </Spacing>\r\n                )}\r\n\r\n                {isFocused && (\r\n                  <Options>\r\n                    <PostImageUpload\r\n                      label=\"Foto\"\r\n                      handleChange={handlePostImageUpload}\r\n                    />\r\n\r\n                    <Buttons>\r\n                      <Button text type=\"button\" onClick={handleReset}>\r\n                        Cancelar\r\n                      </Button>\r\n                      <Button disabled={isShareDisabled} type=\"submit\">\r\n                       Compartilha\r\n                      </Button>\r\n                    </Buttons>\r\n                  </Options>\r\n                )}\r\n\r\n                {apiError ||\r\n                  (error && (\r\n                    <Spacing top=\"xs\" bottom=\"sm\">\r\n                      <Error size=\"xs\">\r\n                        {apiError\r\n                          ? 'Something went wrong, please try again.'\r\n                          : error}\r\n                      </Error>\r\n                    </Spacing>\r\n                  ))}\r\n              </form>\r\n            </Root>\r\n          </>\r\n        );\r\n      }}\r\n    </Mutation>\r\n  );\r\n};\r\n\r\nexport default CreatePost;\r\n"]},"metadata":{},"sourceType":"module"}